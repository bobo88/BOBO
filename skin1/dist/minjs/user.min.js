!function(e,a,r){a.USER={allAjaxUrl:{editProfileUrl:"/m-users-a-edit_profile.html",changePasswordUrl:"/m-users-a-change_password.html",articlePublishUrl:"/m-users-a-article_publish.html",addHomeBannerUrl:"/m-users-a-add_home_banner.html",changeHomeBannerUrl:"/m-users-a-change_home_banner.html",removeHomeBannerUrl:"/m-users-a-remove_home_banner.html",addRefBookUrl:"/m-users-a-add_refbook.html",changeRefBookUrl:"/m-users-a-change_refbook.html",removeRefBookUrl:"/m-users-a-remove_refbook.html",addWeiUrl:"/m-users-a-wei_add.html",changeWeiUrl:"/m-users-a-wei_change.html",removeWeiUrl:"/m-users-a-wei_remove.html",addDemocaseUrl:"/m-users-a-democase_add.html",changeDemocaseUrl:"/m-users-a-democase_change.html",removeDemocaseUrl:"/m-users-a-democase_remove.html"},linkToUrl:{loginUrl:"/sign.html",myProfileUrl:"/my-profile.html",articleUrl:"/m-article-publish.html",homeBannerUrl:"/m-home.html",refBookUrl:"/m-ref-book.html",weiUrl:"/m-wei-topic.html",democaseUrl:"/m-demo-case.html"},userAjax:{getAjaxPromise:function(a,r){r=arguments.length>1?r:!0;var t={type:"POST",global:!0,dataType:"json"};a=e.extend({},t,a);var l=e.ajax(a);return r&&this.ajaxSuccessCall(l),l},ajaxSuccessCall:function(e){var a=this;e.done(function(e){0!=e.status&&a.ajaxSuccessFailCall(e)})},ajaxSuccessFailCall:function(e){var a=e.msg;USER.otherGlobal.layerAlertReload(a)}},profile:{profileFormObj:"",changePassFormObj:"",profileValidate:function(){USER.otherGlobal.getMyValidate(this.profileFormObj,{rules:{nickname:{rangelength:[4,25]},email:{email:!0},profilecode:{required:!0,maxlength:4,minlength:4}},messages:{nickname:{rangelength:e.validator.format("昵称长度在 {0} 和 {1} 之间")},email:{email:"请输入正确的邮箱地址"},profilecode:{required:"请输入验证码",maxlength:"验证码长度必须为4位",minlength:"验证码长度必须为4位"}}})},profileForm:function(a){var t=this;t.profileFormObj=a,r.script("jquery.validate.min.js").wait(function(){t.profileValidate(),e(".js_submit").on("click",function(a){a.preventDefault();var r=e(this);return 1===parseInt(r.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"数据保存中，不要着急..."}),!1):void(t.profileFormObj.valid()&&(r.attr("data-doing",1),USER.userAjax.getAjaxPromise({url:USER.allAjaxUrl.editProfileUrl,data:t.profileFormObj.serialize()},!0).done(function(e){1===e.status?USER.otherGlobal.openPop({area:["500px","300px"],end:function(){USER.otherGlobal.windowReload(USER.linkToUrl.myProfileUrl)}}):USER.otherGlobal.layerAlertReload(e.msg),r.attr("data-doing",0)}).fail(function(){USER.otherGlobal.layerAlertReload("个人资料修改失败，点击确定重试！")})))})})},changePassValidate:function(){USER.otherGlobal.getMyValidate(this.changePassFormObj,{rules:{current_password:{required:!0,rangelength:[6,16]},password:{required:!0,rangelength:[6,16],notEqualTo:"#js_currentPass"},password_confirm:{required:!0,rangelength:[6,16],equalTo:e("#js_password")},security_code:{required:!0}},messages:{current_password:{required:"请输入当前密码",rangelength:e.validator.format("密码长度在 {0} 到 {1} 个字符之间")},password:{required:"请输入新密码",rangelength:e.validator.format("密码长度在 {0} 到 {1} 个字符之间"),notEqualTo:"请设置不同的密码"},password_confirm:{required:"请确认密码",rangelength:e.validator.format("密码长度在 {0} 到 {1} 个字符之间"),equalTo:"请确认两次输入密码相同"},security_code:{required:"请输入验证码"}}})},changePassEvent:function(){},changePassForm:function(a){var t=this;t.changePassFormObj=a,t.changePassEvent(),r.script("jquery.validate.min.js").wait(function(){t.changePassValidate(),e(".js_submit").on("click",function(e){e.preventDefault(),t.changePassFormObj.valid()&&USER.userAjax.getAjaxPromise({url:USER.allAjaxUrl.changePasswordUrl,data:t.changePassFormObj.serialize()},!0).done(function(e){1===e.status?USER.otherGlobal.openPop({area:["500px","300px"],end:function(){USER.otherGlobal.windowReload(USER.linkToUrl.loginUrl)}}):USER.otherGlobal.layerAlertReload(e.msg)}).fail(function(){USER.otherGlobal.layerAlertReload("密码修改失败，点击确定重试！")})})})}},article:{articleFormObj:"",articlePublishValidate:function(){USER.otherGlobal.getMyValidate(this.articleFormObj,{rules:{title:{required:!0},summary:{required:!0,maxlength:200,minlength:10},content:{required:!0,minlength:200},keyword:{required:!0}},messages:{title:{required:"请输入文章标题"},summary:{required:"请输入文章简介",maxlength:"文章简介不能大于200个字符",minlength:"文章简介不能小于10个字符"},content:{required:"请输入文章内容",minlength:"文章内容不能小于200个字符"},keyword:{required:"请输入关键词"}}})},articlePublishEvent:function(){this.articleFormObj.find("input,select,textarea").on("focus",function(){var a=e(this),r=a.parents(".options");r.addClass("active").siblings(".options").removeClass("active")})},articlePublishForm:function(a){var t=this;t.articleFormObj=a,t.articlePublishEvent(),r.script("jquery.validate.min.js").wait(function(){t.articlePublishValidate(),e(".js_submit").on("click",function(a){a.preventDefault();var r=e(this);return 1===parseInt(r.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"文章发表中，不要着急..."}),!1):void(t.articleFormObj.valid()&&(r.attr("data-doing",1),USER.userAjax.getAjaxPromise({url:USER.allAjaxUrl.articlePublishUrl,data:t.articleFormObj.serialize()},!0).done(function(e){1===e.status?USER.otherGlobal.openPop({area:["500px","300px"],end:function(){USER.otherGlobal.windowReload(USER.linkToUrl.articleUrl)}}):USER.otherGlobal.layerAlertReload(e.msg),r.attr("data-doing",0)}).fail(function(){USER.otherGlobal.layerAlertReload("文章发表失败，点击确定重试！")})))})})}},home:{addHomeBannerForm:function(a){var r=a;e(".js_submitAdd").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"Banner新增中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.addHomeBannerUrl,reloadUrl:USER.linkToUrl.homeBannerUrl,failAlert:"Banner新增失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})},changeHomeBannerForm:function(a){var r=a;e(".js_submitChange").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"Banner更改中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.changeHomeBannerUrl,reloadUrl:USER.linkToUrl.homeBannerUrl,failAlert:"Banner更改失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})},removeHomeBannerForm:function(a){var r=a;e(".js_submitRemove").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"Banner删除，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.removeHomeBannerUrl,reloadUrl:USER.linkToUrl.homeBannerUrl,failAlert:"Banner删除失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})}},refbook:{addRefBookForm:function(a){var r=a;e(".js_submitAdd").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"参考书籍新增中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.addRefBookUrl,reloadUrl:USER.linkToUrl.refBookUrl,failAlert:"参考书籍新增失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})},changeRefBookForm:function(a){var r=a;e(".js_submitChange").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"参考书籍更改中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.changeRefBookUrl,reloadUrl:USER.linkToUrl.refBookUrl,failAlert:"参考书籍更改失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})},removeRefBookForm:function(a){var r=a;e(".js_submitRemove").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"参考书籍删除中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.removeRefBookUrl,reloadUrl:USER.linkToUrl.refBookUrl,failAlert:"参考书籍删除失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})}},wei:{addWeiTopicForm:function(a){var r=a;e(".js_submitAdd").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"微话题新增中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.addWeiUrl,reloadUrl:USER.linkToUrl.weiUrl,failAlert:"微话题新增失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})},changeWeiTopicForm:function(a){var r=a;e(".js_submitChange").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"微话题更改中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.changeWeiUrl,reloadUrl:USER.linkToUrl.weiUrl,failAlert:"微话题更改失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})},removeWeiTopicForm:function(a){var r=a;e(".js_submitRemove").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"微话题删除中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.removeWeiUrl,reloadUrl:USER.linkToUrl.weiUrl,failAlert:"微话题删除失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})}},democase:{addDemocaseForm:function(a){var r=a;e(".js_submitAdd").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"演示案例新增中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.addDemocaseUrl,reloadUrl:USER.linkToUrl.democaseUrl,failAlert:"演示案例新增失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})},changeDemocaseForm:function(a){var r=a;e(".js_submitChange").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"演示案例更改中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.changeDemocaseUrl,reloadUrl:USER.linkToUrl.democaseUrl,failAlert:"演示案例更改失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})},removeDemocaseForm:function(a){var r=a;e(".js_submitRemove").on("click",function(a){a.preventDefault();var t=e(this),l=r.find("input"),o=USER.otherGlobal.inputRequiredValidate(l),n=null;return o?1===parseInt(t.attr("data-doing"))?(GLOBAL.PopObj.alert({content:"演示案例删除中，不要着急..."}),!1):(t.attr("data-doing",1),n={subBtn:t,thisForm:r,ajaxUrl:USER.allAjaxUrl.removeDemocaseUrl,reloadUrl:USER.linkToUrl.democaseUrl,failAlert:"演示案例删除失败，点击确定重试！"},void USER.otherGlobal.ajaxSubFun(n)):(t.attr("data-doing",0),!1)})}},otherGlobal:{layerIndex:"",windowReload:function(e){e=e||"",""===e?a.location.reload(!0):a.location.href=e},layerAlertReload:function(e,a){a=a||"",layer.alert(e,{end:function(){USER.otherGlobal.windowReload(a)}},function(){USER.otherGlobal.windowReload(a)})},openPop:function(a,r){var t=e("#js_pop"),l=this;if(a=e.extend({},{type:1,shadeClose:!1,title:"提示",area:["500px","350px"],content:t,end:function(){}},a),l.layerIndex=layer.open(a),r=arguments.length>1?r:!1){t=a.content;var o=t.find(".js_cancel");o.off("click"),o.on("click",function(e){e.preventDefault(),layer.close(l.layerIndex)})}},setCheckBox:function(){e(".js_checkbox").click(function(){var a=e(this).siblings(".js_inputCheckbox")[0];e(this).toggleClass("selected"),a.checked=!a.checked})},getMyValidate:function(a,r){return jQuery.validator.addMethod("notEqualTo",function(a,r,t){return this.optional(r)||a!=e(t).val()},"Each element should have a different value"),GLOBAL.validate_addMethod.notEqualTo(),jQuery.validator.setDefaults({debug:!1,success:"valid",ignore:""}),r=e.extend({errorClass:"form-error",wrapper:"p",success:function(e){e.remove()},errorPlacement:function(e,a){a.parent().parent().find(".error").remove(),e.prepend('<span class="span-form-label">&nbsp;</span>'),e.addClass("error").appendTo(a.parent().parent())}},r),a.validate(r)},inputRequiredValidate:function(a){var r=!0;return e.each(a,function(a,t){var l=e(t);l.val().length>0||(GLOBAL.PopObj.alert({content:"请输入完整信息！"}),r=!1)}),r},ajaxSubFun:function(e){USER.userAjax.getAjaxPromise({url:e.ajaxUrl,data:e.thisForm.serialize()},!0).done(function(a){1===a.status?USER.otherGlobal.openPop({area:["500px","300px"],end:function(){USER.otherGlobal.windowReload(e.reloadUrl)}}):USER.otherGlobal.layerAlertReload(a.msg),e.subBtn.attr("data-doing",0)}).fail(function(){USER.otherGlobal.layerAlertReload(e.failAlert)})},resetForm:function(e,a){e.reset(),a.resetForm()}}},e(function(){e("#js-checkpic").click(function(){var a=e(this),r=a.attr("src");a.attr("src",r+"?"+(new Date).getTime())}),e("#js-pbRighttopNav").on("click","li",function(){var a=e(this),r=e("#js-pbRighttopNav").find("li").index(a);a.addClass("current").siblings("li").removeClass("current"),e(".js-pbRightContent").find(".user-global-form").eq(r).show().siblings(".user-global-form").hide()})})}(jQuery,window,$LAB);